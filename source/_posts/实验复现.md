---
title: 实验复现-SpanProto
mathjax: true
index_img: /img/zb.jpg
categories:
  - 论文
date: 2024-08-18 17:56:52
tags:
---
# 论文题目：SpanProto: A Two-stage Span-based Prototypical Network for Few-shot Named Entity Recognition

# 一、动机
这篇文章的主要目的是帮助解决在只有很少标注数据的情况下做好命名实体识别这个问题。因为在我们研究的这个小样本学习场景中，我们没有足够的数据来训练那些通常需要很多数据的复杂模型。目前的方法在处理这种情况时，因为各种原因，比如它们只关注单个词的分类而忽略了词组作为整体的意义，所以效果不是很好。

文章里提出的SpanProto框架，就是为了改进这些不足，它用了一种两步走的方法：先找出可能的实体词组，然后再确定这些词组的具体类型。通过这种方法，模型能更好地理解句子中实体的开始和结束位置，并且通过学习少量数据来适应新的任务。简单来说，就是用一种新的方式来教模型在数据不多的情况下，怎么快速学会识别文本中的实体。

# 二、数据集
本文中使用了两个适合小样本命名实体识别任务的数据集来测试：FewNERD、CrossNER。这些数据集的选择旨在全面评估SpanProto在不同类型的小样本NER任务中的表现，并与现有的强基线方法进行比较。通过在这些数据集上的广泛实验，文章证明了SpanProto方法的有效性和优越性能。

## 1.FewNERD
这是一个专为小样本NER任务设计的数据集，包含了8个粗粒度和66个细粒度的实体类型。FewNERD数据集提供了两种设置：Intra和Inter。在Intra设置中，训练集、开发集和测试集中的所有实体都属于不同的粗粒度类型。而在Inter设置中，只有细粒度实体类型在不同数据集中是互不相交的。

## 2.CrossNER
这个数据集由四个不同的NER领域组成，包括OntoNotes 5.0、CoNLL-2003、GUM和WNUT-17。在训练时，随机选择其中的两个作为训练集，其余两个用作开发集和测试集。最终结果是基于测试集得出的。

# 三、模型
SpanProto分成两个步骤来帮助我们：首先，它用一个叫做"跨度提取器"的工具来找出文本里可能的实体词组，也就是确定这些词组的开始和结束位置；然后，它用"提及分类器"来给这些词组分类，看它们属于哪种类型的实体。为了让分类更准确，它还用了一种叫做"原型学习"的方法，就是通过学习一些已知的实体类型，来帮助识别新的、没见过的实体。最后，如果有时候它不小心把不是实体的词组也选进来了，它还会用一个"边界损失"的方法来纠正这个错误，确保我们得到的结果既准确又可靠。

# 四、具体步骤
这篇文章里，提出了一个叫做SpanProto的新方法，它分两步来解决小样本情况下的命名实体识别问题：

## 1.跨度提取（Span Extraction）
这个阶段的目标是找出文本中所有可能的实体词组，也就是确定实体的边界。传统的方法可能会逐个词地进行分类，但SpanProto采用了一种不同的策略，它将序列标签转换成一个全局边界矩阵。这个矩阵能够表示句子级别的目标标签，帮助模型学习显式的跨度边界信息，而不受逐词标签依赖性的影响。通过这种方法，模型可以专注于识别实体的开始和结束位置，而不是单纯地对每个词进行分类。

## 2.提及分类（Mention Classification）
在这个阶段，模型需要为提取出的每个候选实体词组分配一个预定义的实体类型。这里使用了原型学习的方法，通过计算支持集中每个类型的原型嵌入（即基于支持样本计算出的类别中心表示），然后在语义空间中调整候选跨度的表示，使其更接近相应的原型。为了解决假阳性问题，文章还提出了一种基于边界的损失函数。这个损失函数可以增加假阳性实体与所有原型区域之间的语义距离，从而帮助模型区分真正的实体和错误的提取。

# 五、总结
这篇文章提出了SpanProto，一个创新的两阶段模型，用于解决小样本命名实体识别任务中标注数据不足的问题。模型首先通过跨度提取器确定文本中潜在的实体边界，然后利用提及分类器和原型学习来为这些实体预测类型，同时采用基于边界的损失函数减少错误分类。在标准数据集上的实验显示，SpanProto在小样本NER方面性能卓越，超越了现有技术，为未来在类似任务中的应用提供了新方向。

# 六、论文复现

## 1.查找论文代码
本文的 github 地址为：https://github.com/wjn1996/SpanProto

## 2.租借服务器
在代码 requirements.txt中发现本文使用 torch 版本为 1.8.0，与之相对应 cuda 版本为 11.0，因此租用了RTX 2080 Ti x2(22GB)作为本次复现代码的 gpu。

## 3.安装依赖环境
1. 新建本次复现代码 cuda 虚拟环境，同时将Python版本设为3.8
2. 将代码中所需要的数据集和模型放到代码指定的文件夹中
3. 在代码文件夹中执行`pip install -r requirements.txt `命令安装所有依赖

## 4.执行代码
执行`sh scripts/fewner/run_fewnerd.sh`运行代码

## 5.实验结果
![实验](https://raw.githubusercontent.com/Hua-Wu-Que-Code/picture/main/uPic/EJCnpM.jpg)
